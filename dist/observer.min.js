!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.observer=e():t.observer=e()}(this,function(){return function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return t[r].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var r=n(1),i=r.proxy,o=n(4),s=n(8);window.observer={on:s.on,un:s.un,hasListen:s.hasListen,obj:i.obj,eq:i.eq,proxy:i,getVal:o.get},t.exports=window.observer},function(t,e,n){"use strict";function r(){h.on=h._on,h.un=h._un}function i(t,e){if(handlers=a.get(t),handlers)for(var n=handlers.length-1;n>=0;n--)handlers[n](t,e)}e.__esModule=!0,e.proxyEnable=r,e.proxyChange=i;var o=n(2),s=n(3),a=new o,h=e.proxy={eq:function(t,e){return t===e},obj:function(t){return t},proxy:function(t){return t},on:function(){},un:function(){},_on:function(t,e){var n=void 0;if("function"!=typeof e)throw TypeError("Invalid Proxy Event Handler");t=h.obj(t),n=a.get(t),n||(n=[],a.set(t,n)),n.push(e)},_un:function(t,e){var n=void 0;if(t=h.obj(t),n=a.get(t))if(arguments.length>1){if("function"==typeof e){var r=s.indexOf.call(n,e);-1!=r&&n.splice(r,1)}}else a["delete"](t)}}},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=window.Map;r||!function(){var t={KEY:"key",VALUE:"value",ENTRY:"entry"},e="__hash__",i=0,o=function(){function r(){n(this,r),this._map={},this._keyMap={},this._size=0}return r.prototype._hash=function(t){return t[e]||(t[e]=++i)},r.prototype.has=function(t){return this._hash(t)in this._keyMap},r.prototype.get=function(t){var e=this._hash(t);return e in this._keyMap?this._map[e]:void 0},r.prototype.set=function(t,e){var n=this._hash(t);return this._keyMap[n]=t,this._map[n]=e,n in this._keyMap||this._size++,this},r.prototype["delete"]=function(t){var e=this._hash(t);return e in this._keyMap?(delete this._keyMap[e],delete this._map[e],this._size--,!0):!1},r.prototype.size=function(){return this._size},r.prototype.clear=function(){this._keyMap={},this._map={},this._size=0},r.prototype.forEach=function(t){for(var e in this._map)e in this._keyMap&&t(this._map[e],e,this)},r.prototype.keys=function(){return new s(this,t.KEY)},r.prototype.values=function(){return new s(this,t.VALUE)},r.prototype.entries=function(){return new s(this,t.ENTRY)},r.prototype.toString=function(){return"[Object Map]"},r}(),s=function(){function e(t,r){n(this,e),this._index=0,this._map=t,this._type=r,this._hashs=[];for(var i in t._map)this._hashs.push(i)}return e.prototype.next=function(){var e=void 0;if(this._index<this._hashs.length){var n=this._hashs[this.index++];switch(this._type){case t.KEY:e=this._map._keyMap[n];case t.VALUE:e=this._map._map[n];case t.ENTRY:e=[this._map._keyMap[n],this._map._map[n]];default:throw new TypeError("Invalid iterator type")}}return{value:e,done:this._index>=this._keys.length}},e.prototype.toString=function(){return"[object Map Iterator]"},e}();r=o,r.HASH_BIND=e}(),t.exports=r},function(t,e){"use strict";var n=void 0,r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,i=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame,o=Function.prototype.bind||function(t){if(arguments.length<2&&(void 0===t||null===t))return this;var e=this,n=Array.prototype.slice.call(arguments,1);return function(){return e.apply(t,n.concat(Array.prototype.slice.call(arguments)))}};r&&i?(r=o.call(r,window),i=o.call(i,window)):(r=function(t){var e=(new Date).getTime(),r=Math.max(0,16-(e-n)),i=setTimeout(function(){t(e+r)},r);return n=e+r,i},i=function(t){clearTimeout(t)});var s={requestAnimationFrame:r,cancelAnimationFrame:i,eachObj:function(t,e){var n=Object.prototype.hasOwnProperty;for(var r in t)if(n.call(t,r)&&e(t[r],r)===!1)return!1},bind:o,indexOf:Array.prototype.indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(this[e]===t)return e;return-1}};t.exports=s},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},o=n(5),s=n(1),a=s.proxy,h=n(3),u=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,c={},f=function(){function t(e,n,o){if(r(this,t),!e||!(e instanceof Array||"object"==("undefined"==typeof e?"undefined":i(e))))throw TypeError("can not observe object["+("undefined"==typeof e?"undefined":i(e))+"]");this.expression=n,this.handlers=[],this.path=o||t._parseExpr(n),this.observers=[],this.observeHandlers=this._initObserveHandlers(),this.target=this._observe(e,0),this._onTargetProxy=h.bind.call(this._onTargetProxy,this),a.on(e,this._onTargetProxy)}return t._parseExpr=function(t){if(t instanceof Array)return t;var e=function(){var e=c[t];return e||(e=c[t]=[],(t+"").replace(u,function(t,n,r,i){e.push(r?i.replace(reEscapeChar,"$1"):n||t)})),{v:e}}();return"object"===("undefined"==typeof e?"undefined":i(e))?e.v:void 0},t.get=function(e,n,r){if(e){n=t._parseExpr(n);for(var i=0;e&&i<n.length;)e=e[n[i++]];return i==n.length?e:void 0}return r},t.prototype._onTargetProxy=function(t,e){this.target=e},t.prototype._observe=function(t,e){var n=this.path[e];return e+1<this.path.length&&t[n]&&(t[n]=this._observe(t[n],e+1)),o.on(t,n,this.observeHandlers[e])},t.prototype._unobserve=function(t,e){var n=this.path[e];return t=o.un(t,n,this.observeHandlers[e]),e+1<this.path.length&&(t[n]=this._unobserve(t[n],e+1)),t},t.prototype._initObserveHandlers=function(){for(var t=[],e=0,n=this.path.length;n>e;e++)t.push(this._createObserveHandler(e));return t},t.prototype._createObserveHandler=function(e){var n=this,r=(this.path.slice(0,e+1),this.path.slice(e+1)),i=this.path.length-e-1;return function(o,s,h){if(!i||(n._unobserve(h,e+1),n._observe(s,e+1),h=t.get(h,r),s=t.get(s,r),!a.eq(s,h)))for(var u=n.handlers.slice(),c=0,f=u.length;f>c;c++)u[c](n.expression,s,h,n.target)}},t.prototype.on=function(t){if("function"!=typeof t)throw TypeError("Invalid Observe Handler");return this.handlers.push(t),this},t.prototype.un=function(t){if(arguments.length){if("function"!=typeof t)throw TypeError("Invalid Observe Handler");for(var e=this.handlers,n=e.length-1;n>=0;n--)if(e[n]===t){e.splice(n,1);break}}else this.handlers=[];return this},t.prototype.hasListen=function(t){return arguments.length?-1!=h.indexOf.call(this.handlers,t):!!this.handlers.length},t.prototype.destory=function(){a.un(this.target,this._onTargetProxy);var t=this._unobserve(this.target,0);return this.target=void 0,this.expression=void 0,this.handlers=void 0,this.path=void 0,this.observers=void 0,this.observeHandlers=void 0,this.target=void 0,t},t}();t.exports=f},function(t,e,n){"use strict";var r=n(6),i=n(2),o=n(1),s=o.proxy,a=new i,h={_bind:function(t,e){a.set(t,e)},_unbind:function(t,e){a.get(t)===e&&a["delete"](t)},_get:function(t){return a.get(t)},hasListen:function(t,e,n){var r=void 0,i=arguments.length;return t=s.obj(t),r=a.get(t),r?1==i?!0:2==i?r.hasListen(t,e):r.hasListen(t,e,n):!1},on:function(t,e,n){var i=void 0;return t=s.obj(t),i=a.get(t),i||(i=new r(t),h._bind(t,i)),t=i.on(e,n),i.hasListen()||(h._unbind(t,i),i.destroy()),t},un:function(t,e,n){var r=void 0;return t=s.obj(t),r=a.get(t),r&&(t=arguments.length>2?r.un(e,n):r.un(e),r.hasListen()||(h._unbind(t,r),r.destroy())),t}};t.exports=h},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){_.prototype[t]=e}function o(){i("_init",function(){this._onObserveChanged=v.bind.call(this._onObserveChanged,this)}),i("_destroy",function(){this.es7observe&&(Object.unobserve(this.target,this._onObserveChanged),this.es7observe=void 0)}),i("_onObserveChanged",function(t){for(var e=void 0,n=0,r=t.length;r>n;n++)e=t[n],this.listens[e.name]&&this._addChangeRecord(e.name,e.oldValue)}),i("_watch",function(t){this.es7observe||(Object.observe(this.target,this._onObserveChanged),this.es7observe=!0)}),i("_unwatch",function(t){this.es7observe&&!this.hasListen()&&(Object.unobserve(this.target,this._onObserveChanged),this.es7observe=!1)})}function s(){i("_init",function(){this._onObserveChanged=v.bind.call(this._onObserveChanged,this)}),i("_destroy",function(){this.es7observe&&(Object.unobserve(this.target,this._onObserveChanged),this.es7observe=void 0)}),i("_onObserveChanged",function(t){for(var e=void 0,n=0,r=t.length;r>n;n++)e=t[n],this.listens[e.name]&&this._addChangeRecord(e.name,e.oldValue)}),i("_watch",function(t){this.es7observe||(Object.observe(this.target,this._onObserveChanged),this.es7observe=!0)}),i("_unwatch",function(t){this.es7observe&&!this.hasListen()&&(Object.unobserve(this.target,this._onObserveChanged),this.es7observe=!1)})}function a(){function t(t,e){try{var n=function(){var n=void 0;return t(e,"sentinel",{get:function(){return n},set:function(t){n=t}}),e.sentinel=1,{v:e.sentinel===n}}();if("object"===("undefined"==typeof n?"undefined":h(n)))return n.v}catch(r){return!1}}if(i("_init",function(){this.watchers={}}),i("_destroy",function(){for(var t in this.watchers)this._unwatch(t)}),i("_hockArrayLength",function(t){var e=this;this.target[t]=function(){var n=this.length;Array.prototype[t].apply(this,arguments),e.target.length!=n&&e._addChangeRecord("length",n)}}),i("_watch",function(t){if(!this.watchers[t]){if(this.isArray&&"length"===t)for(var e=0,n=y.length;n>e;e++)this._hockArrayLength(y[e]);else this._defineProperty(t,this.target[t]);this.watchers[t]=!0}}),i("_unwatch",function(t){if(this.watchers[t]){if(this.isArray&&"length"===t)for(var e=0,n=y.length;n>e;e++)delete this.target[y[e]];else this._undefineProperty(t,this.target[t]);delete this.watchers[t]}}),Object.defineProperty&&t(Object.defineProperty,{}))i("_defineProperty",function(t,e){var n=this;this.target=Object.defineProperty(this.target,t,{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){if(e!==r){var i=e;e=r,n._addChangeRecord(t,i)}}})}),i("_undefineProperty",function(t,e){this.target=Object.defineProperty(this.target,t,{enumerable:!0,configurable:!0,writable:!0,value:e})});else if("__defineGetter__"in{})i("_defineProperty",function(t,e){var n=this;this.target.__defineGetter__(t,function(){return e}),this.target.__defineSetter__(t,function(r){if(e!==r){var i=e;e=r,n._addChangeRecord(t,i)}})}),i("_undefineProperty",function(t,e){this.target.__defineGetter__(t,function(){return e}),this.target.__defineSetter__(t,function(t){e=t})});else{if(!c.isSupport())throw new Error("Not Supported.");!function(){var t=_.VBProxyFactory=new c(d);l(),p.obj=t.obj,p.eq=t.eq,p.proxy=t.getVBProxy,i("_defineProperty",function(e,n){var r=this,i=t.obj(this.target),o=t.getVBProxyDesc(i);o||(o=t.getVBProxyDesc(t.createVBProxy(i))),this.target=o.defineProperty(e,{get:function(){return n},set:function(t){if(n!==t){var i=n;n=t,r._addChangeRecord(e,i)}}})}),i("_undefineProperty",function(e,n){var r=t.obj(this.target),i=t.getVBProxyDesc(r);i&&(this.target=i.defineProperty(e,{value:n}),i.hasAccessor()||(this.target=t.freeVBProxy(r)))})}()}}var h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},u=n(7),c=u.VBProxyFactory,f=n(1),p=f.proxy,d=f.proxyChange,l=f.proxyEnable,v=n(3),y=["push","pop","shift","unshift","sort","reverse","splice"],_=function(){function t(e){if(r(this,t),e instanceof Array)this.isArray=!0;else{if(!e||"object"!=("undefined"==typeof e?"undefined":h(e)))throw TypeError("can not observe object["+("undefined"==typeof e?"undefined":h(e))+"]");this.isArray=!1}this.target=e,this.listens={},this.changeRecords={},this._notify=v.bind.call(this._notify,this),this._init()}return t.prototype._fire=function(t,e,n){for(var r=this.listens[t].slice(),i=0,o=r.length;o>i;i++)r[i](t,e,n,this.target)},t.prototype._notify=function(){var t=this;v.eachObj(this.changeRecords,function(e,n){var r=t.target[n];p.eq(r,e)||t._fire(n,r,e)}),this.request_frame=void 0,this.changeRecords={}},t.prototype._addChangeRecord=function(e,n){t.lazy?e in this.changeRecords||(this.changeRecords[e]=n,this.request_frame||(this.request_frame=v.requestAnimationFrame(this._notify))):this._fire(e,this.target[e],n)},t.prototype.hasListen=function(t,e){var n=arguments.length,r=this.listens;if(n){if(1==n){if(console.log(t),"function"==typeof t){for(var i in r)if(-1!=v.indexOf.call(r[i],t))return!0;return!1}return!!r[t]}if(console.log(t,e),"function"!=typeof e)throw TypeError("Invalid Observe Handler");return r[t]&&-1!=v.indexOf.call(r[t],e)}for(var o in r)return!0;return!1},t.prototype.on=function(t,e){if("function"!=typeof e)throw TypeError("Invalid Observe Handler");var n=this.listens[t];return n?n.push(e):(this.listens[t]=[e],this._watch(t)),this.target},t.prototype._cleanListen=function(t){delete this.listens[t],this._unwatch(t)},t.prototype.un=function(t,e){var n=this.listens[t];if(n)if(1==arguments.length)this._cleanListen(t);else{if("function"!=typeof e)throw TypeError("Invalid Observe Handler");for(var r=n.length-1;r>=0;r--)if(n[r]===e){n.splice(r,1),n.length||this._cleanListen(t);break}}return this.target},t.prototype.destroy=function(){this.request_frame&&(v.cancelAnimationFrame(this.request_frame),this.request_frame=void 0),this._destroy(),this.target=void 0,this.listens=void 0,this.changeRecords=void 0},t}();_.lazy=!1,Object.observe?o():window.Proxy?s():a(),t.exports=_},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t){function e(){return"VBClass"+g++}function n(t){return t+"Constructor"}function i(t){return["	Public Property Get [",t,"]\r\n","	On Error Resume Next\r\n","		Set[",t,"] = [",l,'].get("',t,'")\r\n',"	If Err.Number <> 0 Then\r\n","		[",t,"] = [",l,'].get("',t,'")\r\n',"	End If\r\n","	On Error Goto 0\r\n","	End Property\r\n"]}function s(t){return["	Public Property Let [",t,"](val)\r\n","		Call [",l,'].set("',t,'",val)\r\n',"	End Property\r\n","	Public Property Set [",t,"](val)\r\n","		Call [",l,'].set("',t,'",val)\r\n',"	End Property\r\n"]}function a(t,e){var n=void 0,r=void 0,o=void 0,a=void 0,h={};for(n=["Class ",t,"\r\n",y,"\r\n"],r=0,o=e.length;o>r;r++)a=e[r],n.push.apply(n,i(a)),n.push.apply(n,s(a)),h[a]=!0;return n.push("End Class\r\n"),n.join("")}function h(t){var r=[t.length,"[",t.join(","),"]"].join(""),i=_[r];if(i)return i;var o=e();return i=n(o),parseVB(a(o,t)),parseVB(["Function ",i,"(desc)\r\n","	Dim o\r\n","	Set o = (New ",o,")(desc)\r\n","	Set ",i," = o\r\n","End Function"].join("")),_[r]=i,i}function u(e,n){var r=e instanceof Array,i=void 0,o=void 0;if(r){i=f.slice();for(var s in e)s!==l&&(s in d||i.push(s))}else{i=c.slice();for(var a in e)a!==l&&(a in p||i.push(a))}return n=n||new m(e,i),o=window[h(i)](n),n.proxy=o,t(e,o),o}for(var c=[o.HASH_BIND,"hasOwnProperty","toString","toLocaleString","isPrototypeOf","propertyIsEnumerable","valueOf"],f=c.concat(["concat","copyWithin","entries","every","fill","filter","find","findIndex","forEach","indexOf","lastIndexOf","length","map","keys","join","pop","push","reverse","reverseRight","some","shift","slice","sort","splice","toSource","unshift"]),p={},d={},l="__VB_PROXY__",v="__VB_CONST__",y=["	Public [",l,"]\r\n","	Public Default Function [",v,"](desc)\r\n","		set [",l,"] = desc\r\n","		Set [",v,"] = Me\r\n","	End Function\r\n"].join(""),_={},g=0,b=(Object.prototype.hasOwnProperty,c.length-1);b>=0;b--)p[c[b]]=!0;for(var w=f.length-1;w>=0;w--)d[f[w]]=!0;var m=function(){function t(e,n){r(this,t);for(var i={},o=0,s=n.length;s>o;o++)i[o]=!1;this.object=e,this.defines=i,e[l]=this,this.accessorNR=0}return t.prototype.isAccessor=function(t){return t&&(t.get||t.set)},t.prototype.hasAccessor=function(){return!!this.accessorNR},t.prototype.defineProperty=function(t,e){return t in this.defines||(t in this.object||(this.object[t]=void 0),u(this.object,this)),this.isAccessor(e)?(this.accessorNR++,this.defines[t]=e,e.get&&(this.object[t]=e.get())):(this.defines[t]&&(this.defines[t]=!1,this.accessorNR--),this.object[t]=e.value),this.proxy},t.prototype.getPropertyDefine=function(t){return this.defines[t]||void 0},t.prototype.get=function(t){var e=this.defines[t];return e&&e.get?e.get.call(this.proxy):this.object[t]},t.prototype.set=function(t,e){var n=this.defines[t];n&&n.set&&n.set.call(this.proxy,e),this.object[t]=e},t.prototype.destroy=function(){this.defines={}},t}(),x={eq:function(t,e){var n=t[l],r=e[l];return n&&(t=n.object),r&&(e=r.object),t===e},obj:function(t){var e=t[l];return e?e.object:t},isVBProxy:function(t){return v in t},getVBProxy:function(t){var e=t[l];return e?e.proxy:void 0},getVBProxyDesc:function(t){return t[l]},createVBProxy:function(t){var e=t[l];return e&&(t=e.object),u(t,e)},freeVBProxy:function(e){var n=e[l];return n&&(e=n.object,n.destroy(),e[l]=void 0,t(e,void 0)),e}};return x}e.__esModule=!0,e.VBProxyFactory=i;var o=n(2),s=void 0;i.isSupport=function(){if(void 0!==s)return s;if(s=!1,window.VBArray)try{window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),s=!0}catch(t){console.error(t.message,t)}return s}},function(t,e,n){"use strict";var r=n(4),i=n(5),o=n(2),s=n(1),a=s.proxy,h=(n(3),new o),u={_bind:function(t,e){var n=h.get(t);n||h.set(t,n={}),n[e.expression]=e},_unbind:function(t,e){var n=h.get(t);if(n&&n[e.expression]==e){delete n[e.expression];for(var r in n)return;h["delete"](t)}},_get:function(t,e){var n=h.get(t);return n?n[e]:void 0},on:function(t,e,n){var o=r._parseExpr(e);if(o.length>1){var s=void 0;return t=a.obj(t),s=u._get(t,e),s||(s=new r(t,e,o),u._bind(t,s)),s.on(n),s.target}return i.on(t,e,n)},un:function(t,e,n){var o=r._parseExpr(e);if(o.length>1){var s=void 0;if(t=a.obj(t),s=u._get(t,e))return arguments.length>2?s.un(n):s.un(),s.hasListen()?s.target:(u._unbind(t,s),s.destory());var h=i._get(t);return h?h.target:t}return i.un(t,e,n)},hasListen:function(t,e,n){var o=arguments.length;if(1==o)return i.hasListen(t);if(2==o&&"function"==typeof e)return i.hasListen(t,e);var s=r._parseExpr(e);if(s.length>1){var a=u._get(t,e);return a?2==o?!0:a.hasListen(n):!1}return 2==o?i.hasListen(t,e):i.hasListen(t,e,n)}};t.exports=u}])});