!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.observer=t():e.observer=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";var r=n(1),o=r.proxy,i=n(4),s=n(9),a=n(7);window.observer={on:s.on,un:s.un,hasListen:s.hasListen,obj:o.obj,eq:o.eq,proxy:o,getVal:i.get,defineProperty:a.defineProperty,defineProperties:a.defineProperties,getOwnPropertyDescriptor:a.getOwnPropertyDescriptor},e.exports=window.observer},function(e,t,n){"use strict";function r(e,t){if(handlers=s.get(e),handlers)for(var n=handlers.length-1;n>=0;n--)handlers[n](e,t)}t.__esModule=!0,t.proxyChange=r;var o=n(2),i=n(3),s=new o,a=t.proxy={isEnable:function(){return window.VBProxy},eq:function(e,t){if(window.VBProxy){var n=window.VBProxy.getVBProxyDesc(e),r=window.VBProxy.getVBProxyDesc(t);n&&(e=n.object),r&&(t=r.object)}return e===t},obj:function(e){if(window.VBProxy){var t=window.VBProxy.getVBProxyDesc(e);return t?t.object:e}return e},proxy:function(e){return window.VBProxy?window.VBProxy.getVBProxy(e)||e:e},on:function(e,t){var n=void 0;if(window.VBProxy){if("function"!=typeof t)throw TypeError("Invalid Proxy Event Handler");e=a.obj(e),n=s.get(e),n||(n=[],s.set(e,n)),n.push(t)}},un:function(e,t){var n=void 0;if(window.VBProxy&&(e=a.obj(e),n=s.get(e)))if(arguments.length>1){if("function"==typeof t){var r=i.indexOf.call(n,t);-1!=r&&n.splice(r,1)}}else s["delete"](e)}}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=window.Map;o||!function(){var e=function(e){return("undefined"==typeof e?"undefined":r(e))+" "+(!e||"object"!=("undefined"==typeof e?"undefined":r(e))&&"function"!=typeof e?e+"":e[i]||(e[i]=++s))},t={KEY:"key",VALUE:"value",ENTRY:"entry"},i="__hash__",s=0,a=function(){function r(){n(this,r),this._map={},this._keyMap={},this._size=0}return r.prototype.has=function(t){return e(t)in this._keyMap},r.prototype.get=function(t){var n=e(t);return n in this._keyMap?this._map[n]:void 0},r.prototype.set=function(t,n){var r=e(t);return this._keyMap[r]=t,this._map[r]=n,r in this._keyMap||this._size++,this},r.prototype["delete"]=function(t){var n=e(t);return n in this._keyMap?(delete this._keyMap[n],delete this._map[n],this._size--,!0):!1},r.prototype.size=function(){return this._size},r.prototype.clear=function(){this._keyMap={},this._map={},this._size=0},r.prototype.forEach=function(e){for(var t in this._map)t in this._keyMap&&e(this._map[t],t,this)},r.prototype.keys=function(){return new u(this,t.KEY)},r.prototype.values=function(){return new u(this,t.VALUE)},r.prototype.entries=function(){return new u(this,t.ENTRY)},r.prototype.toString=function(){return"[Object Map]"},r}(),u=function(){function e(t,r){n(this,e),this._index=0,this._map=t,this._type=r}return e.prototype.next=function(){this._hashs||(this._hashs=Object.keys(this._map._map));var e=void 0;if(this._index<this._hashs.length){var n=this._hashs[this.index++];switch(this._type){case t.KEY:e=this._map._keyMap[n];case t.VALUE:e=this._map._map[n];case t.ENTRY:e=[this._map._keyMap[n],this._map._map[n]];default:throw new TypeError("Invalid iterator type")}}return{value:e,done:this._index>=this._keys.length}},e.prototype.toString=function(){return"[object Map Iterator]"},e}();o=a}(),e.exports=o},function(e,t){"use strict";var n=void 0,r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame,o=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame,i=Function.prototype.bind||function(e){if(arguments.length<2&&(void 0===e||null===e))return this;var t=this,n=Array.prototype.slice.call(arguments,1);return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}};r&&o?(r=i.call(r,window),o=i.call(o,window)):(r=function(e){var t=(new Date).getTime(),r=Math.max(0,16-(t-n)),o=setTimeout(function(){e(t+r)},r);return n=t+r,o},o=function(e){clearTimeout(e)});var s={requestAnimationFrame:r,cancelAnimationFrame:o,eachObj:function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t(e[n],n)===!1)return!1},bind:i,indexOf:Array.prototype.indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(this[t]===e)return t;return-1}};e.exports=s},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=n(5),s=n(1),a=s.proxy,u=n(3),c=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,f=function(){function e(t,n,i){if(r(this,e),!t||!(t instanceof Array||"object"==("undefined"==typeof t?"undefined":o(t))))throw TypeError("can not observe object["+("undefined"==typeof t?"undefined":o(t))+"]");this.expression=n,this.handlers=[],this.path=i||e._parseExpr(n),this.observers=[],this.observeHandlers=this._initObserveHandlers(),this.target=this._observe(t,0),this._onTargetProxy=u.bind.call(this._onTargetProxy,this),a.on(t,this._onTargetProxy)}return e._parseExpr=function(e){if(e instanceof Array)return e;var t=function(){var t=[];return(e+"").replace(c,function(e,n,r,o){t.push(r?o.replace(reEscapeChar,"$1"):n||e)}),{v:t}}();return"object"===("undefined"==typeof t?"undefined":o(t))?t.v:void 0},e.get=function(t,n,r){if(t){n=e._parseExpr(n);for(var o=0;t&&o<n.length;)t=t[n[o++]];return o==n.length?t:void 0}return r},e.prototype._onTargetProxy=function(e,t){this.target=t},e.prototype._observe=function(e,t){var n=this.path[t];return t+1<this.path.length&&e[n]&&(e[n]=this._observe(e[n],t+1)),i.on(e,n,this.observeHandlers[t])},e.prototype._unobserve=function(e,t){var n=this.path[t];return e=i.un(e,n,this.observeHandlers[t]),t+1<this.path.length&&(e[n]=this._unobserve(e[n],t+1)),e},e.prototype._initObserveHandlers=function(){for(var e=[],t=0,n=this.path.length;n>t;t++)e.push(this._createObserveHandler(t));return e},e.prototype._createObserveHandler=function(t){var n=this,r=(this.path.slice(0,t+1),this.path.slice(t+1)),o=this.path.length-t-1;return function(i,s,u){if(!o||(n._unobserve(u,t+1),n._observe(s,t+1),u=e.get(u,r),s=e.get(s,r),!a.eq(s,u)))for(var c=n.handlers.slice(),f=0,h=c.length;h>f;f++)c[f](n.expression,s,u,n.target)}},e.prototype.on=function(e){if("function"!=typeof e)throw TypeError("Invalid Observe Handler");return this.handlers.push(e),this},e.prototype.un=function(e){if(arguments.length){if("function"!=typeof e)throw TypeError("Invalid Observe Handler");for(var t=this.handlers,n=t.length-1;n>=0;n--)if(t[n]===e){t.splice(n,1);break}}else this.handlers=[];return this},e.prototype.hasListen=function(e){return arguments.length?-1!=u.indexOf.call(this.handlers,e):!!this.handlers.length},e.prototype.destory=function(){a.un(this.target,this._onTargetProxy);var e=this._unobserve(this.target,0);return this.target=void 0,this.expression=void 0,this.handlers=void 0,this.path=void 0,this.observers=void 0,this.observeHandlers=void 0,this.target=void 0,e},e}();e.exports=f},function(e,t,n){"use strict";var r=n(6),o=n(2),i=n(1),s=i.proxy,a=new o,u={_bind:function(e,t){a.set(e,t)},_unbind:function(e,t){a.get(e)===t&&a["delete"](e)},_get:function(e){return a.get(e)},hasListen:function(e,t,n){var r=void 0,o=arguments.length;return e=s.obj(e),r=a.get(e),r?1==o?!0:2==o?r.hasListen(e,t):r.hasListen(e,t,n):!1},on:function(e,t,n){var o=void 0;return e=s.obj(e),o=a.get(e),o||(o=new r(e),u._bind(e,o)),e=o.on(t,n),o.hasListen()||(u._unbind(e,o),o.destroy()),e},un:function(e,t,n){var r=void 0;return e=s.obj(e),r=a.get(e),r&&(e=arguments.length>2?r.un(t,n):r.un(t),r.hasListen()||(u._unbind(e,r),r.destroy())),e}};e.exports=u},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){h.prototype[e]=t}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=n(7),a=n(1),u=a.proxy,c=n(3),f=["push","pop","shift","unshift","sort","reverse","splice"],h=function(){function e(t){if(r(this,e),t instanceof Array)this.isArray=!0;else{if(!t||"object"!=("undefined"==typeof t?"undefined":i(t)))throw TypeError("can not observe object["+("undefined"==typeof t?"undefined":i(t))+"]");this.isArray=!1}this.target=t,this.listens={},this.changeRecords={},this._notify=c.bind.call(this._notify,this),this._init()}return e.prototype._fire=function(e,t,n){for(var r=this.listens[e].slice(),o=0,i=r.length;i>o;o++)r[o](e,t,n,this.target)},e.prototype._notify=function(){var e=this;c.eachObj(this.changeRecords,function(t,n){var r=e.target[n];u.eq(r,t)||e._fire(n,r,t)}),this.request_frame=void 0,this.changeRecords={}},e.prototype._addChangeRecord=function(t,n){e.lazy?t in this.changeRecords||(this.changeRecords[t]=n,this.request_frame||(this.request_frame=c.requestAnimationFrame(this._notify))):this._fire(t,this.target[t],n)},e.prototype.hasListen=function(e,t){var n=arguments.length,r=this.listens;if(n){if(1==n){if("function"==typeof e){for(var o in r)if(-1!=c.indexOf.call(r[o],e))return!0;return!1}return!!r[e]}if("function"!=typeof t)throw TypeError("Invalid Observe Handler");return r[e]&&-1!=c.indexOf.call(r[e],t)}for(var i in r)return!0},e.prototype.on=function(e,t){if("function"!=typeof t)throw TypeError("Invalid Observe Handler");var n=this.listens[e];return n?n.push(t):(this.listens[e]=[t],this._watch(e)),this.target},e.prototype._cleanListen=function(e){delete this.listens[e],this._unwatch(e)},e.prototype.un=function(e,t){var n=this.listens[e];if(n)if(1==arguments.length)this._cleanListen(e);else{if("function"!=typeof t)throw TypeError("Invalid Observe Handler");for(var r=n.length-1;r>=0;r--)if(n[r]===t){n.splice(r,1),n.length||this._cleanListen(e);break}}return this.target},e.prototype.destroy=function(){this.request_frame&&(c.cancelAnimationFrame(this.request_frame),this.request_frame=void 0),this._destroy(),this.target=void 0,this.listens=void 0,this.changeRecords=void 0},e}();h.lazy=!1,Object.observe?(o("_init",function(){this._onObserveChanged=c.bind.call(this._onObserveChanged,this)}),o("_destroy",function(){this.es7observe&&(Object.unobserve(this.target,this._onObserveChanged),this.es7observe=void 0)}),o("_onObserveChanged",function(e){for(var t=void 0,n=0,r=e.length;r>n;n++)t=e[n],this.listens[t.name]&&this._addChangeRecord(t.name,t.oldValue)}),o("_watch",function(e){this.es7observe||(Object.observe(this.target,this._onObserveChanged),this.es7observe=!0)}),o("_unwatch",function(e){this.es7observe&&!this.hasListen()&&(Object.unobserve(this.target,this._onObserveChanged),this.es7observe=!1)})):(o("_init",function(){this.watchers={}}),o("_destroy",function(){for(var e in this.watchers)this._unwatch(e)}),o("_defineProperty",function(e,t){var n=this;this.target=s.defineProperty(this.target,e,{enumerable:!0,configurable:!0,get:function(){return t},set:function(r){if(t!==r){var o=t;t=r,n._addChangeRecord(e,o)}}})}),o("_undefineProperty",function(e,t){this.target=s.defineProperty(this.target,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}),o("_hockArrayLength",function(e){var t=this;this.target[e]=function(){var n=this.length;Array.prototype[e].apply(this,arguments),t.target.length!=n&&t._addChangeRecord("length",n)}}),o("_watch",function(e){if(!this.watchers[e]){if(this.isArray&&"length"===e)for(var t=0,n=f.length;n>t;t++)this._hockArrayLength(f[t]);else this._defineProperty(e,this.target[e]);this.watchers[e]=!0}}),o("_unwatch",function(e){if(this.watchers[e]){if(this.isArray&&"length"===e)for(var t=0,n=f.length;n>t;t++)delete this.target[f[t]];else this._undefineProperty(e,this.target[e]);delete this.watchers[e]}})),e.exports=h},function(e,t,n){"use strict";function r(e,t){try{var n=function(){var n=void 0;return e.defineProperty(t,"sentinel",{get:function(){return n},set:function(e){n=e}}),t.sentinel=1,{v:t.sentinel===n}}();if("object"===("undefined"==typeof n?"undefined":o(n)))return n.v}catch(r){return!1}}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},i=n(3),s=Object;Object.defineProperty&&r(Object,{})||("__defineGetter__"in{}?s={defineProperty:function(e,t,n){return"value"in n&&(e[t]=n.value),"get"in n&&e.__defineGetter__(t,n.get),"set"in n&&e.__defineSetter__(t,n.set),e},defineProperties:function(e,t){return i.eachObj(t,function(t,n){e=s.defineProperty(e,n,t)}),e},getOwnPropertyDescriptor:function(e,t){var n=e.__lookupGetter__(t),r=e.__lookupSetter__(t),o={writable:!0,enumerable:!0,configurable:!0};return n?(o.get=n,o.set=r):o.value=e[t],o}}:n(8)&&(s={defineProperty:function(e,t,n){var r=void 0,o=void 0,i=n.get||n.set;return VBProxy.isVBProxy(e)&&(r=e,e=VBProxy.getVBProxyDesc(r).object),r||i?(t in e||(e[t]=void 0),r=VBProxy.createVBProxy(r||e),o=VBProxy.getVBProxyDesc(r),o.defineProperty(t,n),o.hasAccessor()?r:(r.__destory__(),e)):(e[t]=n.value,e)},defineProperties:function(e,t){var n=void 0,r=void 0,o=void 0;return VBProxy.isVBProxy(e)&&(n=e,e=VBProxy.getVBProxyDesc(n).object),o=i.eachObj(t,function(e,t){return!(e.get&&e.set)})===!1,n||o?(i.eachObj(t,function(t,n){n in e||(e[n]=void 0)}),n=VBProxy.createVBProxy(n||e),r=VBProxy.getVBProxyDesc(n),i.eachObj(t,function(e,t){r.defineProperty(t,e)}),r.hasAccessor()?n:(n.__destory__(),e)):(i.eachObj(t,function(t,n){e[n]=t.value}),e)},getOwnPropertyDescriptor:function(e,t){var n=void 0,r=void 0;if(VBProxy.isSupport()&&(n=VBProxy.getVBProxy(e))){if(!n.hasOwnProperty(t))return;e=n.__proxy__.object,r=n.__proxy__.getPropertyDefine(t)}return r||{value:e[t],writable:!0,enumerable:!0,configurable:!0}}})),e.exports=s},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){var e=!1;if(window.VBArray)try{window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),e=!0}catch(t){console.error(t.message,t)}return e}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=n(3),a=n(1),u=a.proxyChange;o()&&!function(){var e=function(){return"VBClass"+w++},t=function(e){return e+"Factory"},o=function(e){return["	Public Property Get [",e,"]\r\n","	On Error Resume Next\r\n","		Set[",e,"] = [",l,'].get(Me, "',e,'")\r\n',"	If Err.Number <> 0 Then\r\n","		[",e,"] = [",l,'].get(Me, "',e,'")\r\n',"	End If\r\n","	On Error Goto 0\r\n","	End Property\r\n"]},a=function(e){return["	Public Property Let [",e,"](val)\r\n","		Call [",l,'].set(Me, "',e,'",val)\r\n',"	End Property\r\n","	Public Property Set [",e,"](val)\r\n","		Call [",l,'].set(Me, "',e,'",val)\r\n',"	End Property\r\n"]},c=function(e,t,n){var r=[],i=void 0,u=void 0,c=void 0,f=[];for(r.push("Class ",e,"\r\n",_,"\r\n"),i=0,u=n.length;u>i;i++)c=n[i],r.push.apply(r,a(c)),r.push.apply(r,o(c)),f.push(c);for(i=0,u=t.length;u>i;i++)c=t[i],-1==s.indexOf.call(f,c)&&r.push("	Public [",c,"]\r\n");return r.push("End Class\r\n"),r.join("")},f=function(n,r){var o=void 0,i=void 0,s="["+n.join(",")+"]&&["+r.join(",")+"]";return o=b[s],o?t(o):(o=e(),i=t(o),window.parseVB(c(o,n,r)),window.parseVB(["Function "+i+"(desc)","	Dim o","	Set o = (New "+o+")(desc)","	Set "+i+" = o","End Function"].join("\r\n")),b[s]=o,i)},h=function(e,t){var n=[],r=["__hash__","__destory__"],o=void 0,i=void 0,a=void 0;t=t||new x(e);for(name in e)n.push(name);for(r=r.concat(y),"[object Array]"===Object.prototype.toString.call(e)&&(r=r.concat(d)),proxy=window[f(r,n)](t),proxy.hasOwnProperty=function(e){return e!==l&&e!==v&&-1==s.indexOf.call(r,e)},proxy.__destory__=function(){g.get(e)===proxy&&(g["delete"](e),u(e,e))},o=0,i=r.length;i>o;o++)name=r[o],"undefined"==typeof proxy[name]&&(a=e[name],"function"==typeof a&&(a=s.bind.call(a,e)),proxy[name]=a);return proxy},p=n(2),y=["hasOwnProperty","toString","toLocaleString","isPrototypeOf","propertyIsEnumerable","valueOf"],d=["concat","copyWithin","entries","every","fill","filter","find","findIndex","forEach","indexOf","lastIndexOf","length","map","keys","join","pop","push","reverse","reverseRight","some","shift","slice","sort","splice","toSource","unshift"],l="__PROXY__",v="__VB_CONST__",_=["	Public ["+l+"]","	Public Default Function ["+v+"](desc)","		set ["+l+"] = desc","		Set ["+v+"] = Me","	End Function\r\n"].join("\r\n"),b={},g=new p,w=0,x=function(){function e(t,n){r(this,e),this.object=t,this.defines=n||{}}return e.prototype.isAccessor=function(e){return e.get||e.set},e.prototype.hasAccessor=function(){for(var e in this.defines)if(this.isAccessor(this.defines[e]))return!0;return!1},e.prototype.defineProperty=function(e,t){this.isAccessor(t)?(this.defines[e]=t,t.get&&(this.object[e]=t.get())):delete this.defines[e]},e.prototype.getPropertyDefine=function(e){return this.defines[e]},e.prototype.get=function(e,t){var n=this.defines[t];return n&&n.get?n.get.call(e):this.object[t]},e.prototype.set=function(e,t,n){var r=this.defines[t];r&&r.set&&r.set.call(e,n),this.object[t]=n},e}(),m={isVBProxy:function(e){return e&&"object"==("undefined"==typeof e?"undefined":i(e))&&v in e},getVBProxy:function(e,t){if(m.isVBProxy(e)){if(t===!1)return g.get(e[l].object)||e;e=e[l].object}return g.get(e)},getVBProxyDesc:function(e){var t=m.isVBProxy(e)?e:g.get(e);return t?t[l]:void 0},createVBProxy:function(e){var t=m.getVBProxy(e,!1),n=!1,r=void 0;if(t){if(e=t[l].object,n=s.eachObj(e,function(e,n){return t.hasOwnProperty(n)})===!1,!n)return t;r=t[l]}return t=h(e,r),g.set(e,t),u(e,t),t}};window.VBProxy=m}(),e.exports=window.VBProxy},function(e,t,n){"use strict";var r=n(4),o=n(5),i=n(2),s=n(1),a=s.proxy,u=(n(3),new i),c={_bind:function(e,t){var n=u.get(e);n||u.set(e,n={}),n[t.expression]=t},_unbind:function(e,t){var n=u.get(e);if(n&&n[t.expression]==t){delete n[t.expression];for(var r in n)return;u["delete"](e)}},_get:function(e,t){var n=u.get(e);return n?n[t]:void 0},on:function(e,t,n){var i=r._parseExpr(t);if(i.length>1){var s=void 0;return e=a.obj(e),s=c._get(e,t),s||(s=new r(e,t,i),c._bind(e,s)),s.on(n),s.target}return o.on(e,t,n)},un:function(e,t,n){var i=r._parseExpr(t);if(i.length>1){var s=void 0;if(e=a.obj(e),s=c._get(e,t))return arguments.length>2?s.un(n):s.un(),s.hasListen()?s.target:(c._unbind(e,s),s.destory());var u=o._get(e);return u?u.target:e}return o.un(e,t,n)},hasListen:function(e,t,n){var i=arguments.length;if(1==i)return o.hasListen(e);if(2==i&&"function"==typeof t)return o.hasListen(e,t);var s=r._parseExpr(t);if(s.length>1){var a=c._get(e,t);return a?2==i?!0:a.hasListen(n):!1}return 2==i?o.hasListen(e,t):o.hasListen(e,t,n)}};e.exports=c}])});